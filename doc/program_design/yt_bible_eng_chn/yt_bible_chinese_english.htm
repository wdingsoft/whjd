<html>

<head>
    <base target="_blank" />
    <META http-equiv="Content-Type" content="text/html;" charset="UTF-8">
    <META name="viewport" content="width=device-witdh, initial-scale=1, maximum-scale=1, user-scale=0">

    <script src="../jq/jquery-2_1_3.min.js"></script>
    <script src="./dat/yt_data.js"></script>
    <script src="./dat/yt_data_English_5perday.js"></script>

    <style>
        .about_I {
            background-color: red;
        }

        .plus {
            background-color: antiquewhite
        }

        #TableOfContent {
            background-color: rgb(239, 238, 238);
            height: 600px;
            overflow: scroll;
            border: 1px solid black;
            margin-left: 20px;
        }

        a[href_vid] {

            font-size: large;
        }

        .hili {
            background-color: chartreuse;
        }

        #ytspeed {
            width: 50px;
        }
    </style>
    <script>
        $(function () {
            $(".plus").next().hide()
            $(".plus").on("click", function () {
                $(this).next()
                    .slideToggle()
                    .attr("contenteditable", "true")
            })

            gen_lst([yt_data, yt_data_English_5perday])
        })

        function bind_yt_player() {
            $("a[href_vid]").on("click", function () {
                $(".hili").removeClass("hili")
                $(this).addClass("hili")

                var surl = $(this).attr("href_vid")
                const urlParams = new URL(surl);
                var vid = urlParams.searchParams.get("v")
                var startSeconds = $(this).attr("startSeconds")

                var speed = $("#ytspeedop").val()
                var url = `./yt_iframe_app/yt_iframe_videoID.htm?vid=${vid}&speed=${speed}&startSeconds=${startSeconds}`
                console.log("url=", url)

                $("iframe").attr("src", url)
            })
        }

        function get_trs(yt_obj) {

            function get_sec(mm_ss) {
                if (!mm_ss) return 0
                var sec = 0;
                var mat = mm_ss.match(/(\d):(\d)/)
                if (mat) {
                    var sec = parseFloat(mat[1])
                    sec *= 60
                    sec += parseFloat(mat[2])
                }
                return sec;
            }


            var str = "", idx = 0
            for (const [ur, ar] of Object.entries(yt_obj)) {
                if (!ur) continue;
                var start = ar[1].start;

                var startSeconds = get_sec(start)
                str += `<tr><td>${idx++}</td><td><a href_vid='${ur}' startSeconds='${startSeconds}'>${ar[0]} (${start})</a></td></tr>`

            }
            return str;
        }

        function gen_lst(yt_obj_ary) {
            var str = ""

            for (var i = 0; i < yt_obj_ary.length; i++) {
                str += get_trs(yt_obj_ary[i])
            }

            $("#mylist").html(`<table border='1'>${str}</table>`)

            bind_yt_player()
        }

    </script>

</head>

<body>
    <div>
        <iframe xsrc="./ElderEnglish_YouTubeSpeedx0.75.htm" frameborder="1" class="" width="660" height="400"></iframe>
        <br>
        <div name="yt_ctr">
            <a>Speed:</a>
            <select name="ytspeed" id="ytspeedop">
                <option value="0.75">0.75</option>
                <option value="1.00">1.00</option>
                <option value="1.25">1.25</option>
                <option value="1.50">1.50</option>
                <option value="1.75">1.75</option>
                <option value="2.00">2.00</option>
            </select>
        </div>
    </div>

    <div id="TableOfContent">
        <h1>读《圣经》,学英文</h1>
        <a>The purpose to study any language is to know the Bible.</a>

        <div id="mylist"></div>


    </div>
</body>

</html>